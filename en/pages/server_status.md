
# Server Status

Currently three servers are available:

```bash
tk1:
ssh USERNAME@rover.teamdiana.org -p 587
udoo:
ssh USERNAME@rover.teamdiana.org -p 3389
rpi2:
ssh USERNAME@rover.teamdiana.org 
```

## TK1

A Jetson TK-1 devkit. This server will be the heart of the T0-R0 rover. 

|                    |                         |
|--------------------|-------------------------|
| local ip address   | 10.0.0.5                |
| public ssh address | rover.teamdiana.org:587 |
| hostname           | tk1                     |



## Udoo Quad

A Udoo Quad board. This server will be the mate of the tk1 inside the T0-R0 rover.

|                    |                          |
|--------------------|--------------------------|
| local ip address   | 10.0.0.4                 |
| public ssh address | rover.teamdiana.org:3389 |
| hostname           | udoo                     |

## Raspberry PI 2 

A raspberry pi 2 board. Used as NAS, server for useful stuff and a lot more

|                    |                        |
|--------------------|------------------------|
| local ip address   | 10.0.0.2               |
| public ssh address | rover.teamdiana.org:22 |
| hostname           | rpi2                   |


## Configuration

The servers are connected to the same physical subnet via a switch. The Raspberry PI 2 (**rpi2**) forwards the packets between our 
unique public ip address (**130.192.165.62**) and each server. SSH is forwared using different ports. 
By default, external connections from a board (such as http) are automatically **nat**ted by rpi2.

### IP tables of rpi2

```bash
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         
DNAT       tcp  --  anywhere             anywhere             tcp dpt:ms-wbt-server to:10.0.0.4:22
DNAT       tcp  --  anywhere             anywhere             tcp dpt:submission to:10.0.0.5:22

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         
MASQUERADE  all  --  anywhere             anywhere            
MASQUERADE  all  --  anywhere             anywhere
```

configuration, can be restored with 
```bash
iptables-restore < FILENAME
```

```bash
# Generated by iptables-save v1.6.0 on Tue May 24 06:59:52 2016
*nat
:PREROUTING ACCEPT [3143:389666]
:INPUT ACCEPT [924:116366]
:OUTPUT ACCEPT [6:456]
:POSTROUTING ACCEPT [0:0]
-A PREROUTING -i eth0 -p tcp -m tcp --dport 3389 -j DNAT --to-destination 10.0.0.4:22
-A PREROUTING -i eth0 -p tcp -m tcp --dport 587 -j DNAT --to-destination 10.0.0.5:22
-A POSTROUTING -o eth0 -j MASQUERADE
-A POSTROUTING -o eth0 -j MASQUERADE
COMMIT
# Completed on Tue May 24 06:59:52 2016
# Generated by iptables-save v1.6.0 on Tue May 24 06:59:52 2016
*filter
:INPUT ACCEPT [1834:224416]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [169:19032]
-A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -i eth0 -o eth0 -j ACCEPT
COMMIT
# Completed on Tue May 24 06:59:52 2016
```
